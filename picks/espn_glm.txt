
R version 3.1.3 (2015-03-09) -- "Smooth Sidewalk"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> games <- read.csv("outcomes.csv", header=TRUE)
> teams <- read.csv("teams.csv", header=TRUE)
> 
> games$team <- as.factor(games$team)
> games$opponent <- as.factor(games$opponent)
> 
> games <- rbind(games, data.frame(team=games$opponent, opponent=games$team, won=games$lost, lost=games$won))
> 
> head(games)
  team opponent    won lost
1    1        1      0    0
2   64       64      0    0
3    1        2 425850 6270
4    1        3 198058 4075
5    1        4 218806 4911
6    1        5 107224 5690
> 
> dim(games)
[1] 4022    4
> 
> fit <- glm(cbind(won,lost) ~ team+opponent, family=binomial(logit), data=games)
> 
> fit

Call:  glm(formula = cbind(won, lost) ~ team + opponent, family = binomial(logit), 
    data = games)

Coefficients:
(Intercept)        team2        team3        team4        team5        team6  
  2.087e-15   -3.953e+00   -3.746e+00   -3.640e+00   -3.096e+00   -3.927e+00  
      team7        team8        team9       team10       team11       team12  
 -2.400e+00   -4.175e+00   -2.861e+00   -3.058e+00   -1.477e+00   -4.437e+00  
     team13       team14       team15       team16       team17       team18  
 -2.430e+00   -3.284e+00   -1.848e+00   -4.798e+00   -9.495e-01   -4.409e+00  
     team19       team20       team21       team22       team23       team24  
 -3.388e+00   -3.839e+00   -3.012e+00   -4.524e+00   -1.890e+00   -4.064e+00  
     team25       team26       team27       team28       team29       team30  
 -3.372e+00   -3.929e+00   -2.412e+00   -4.702e+00   -3.180e+00   -2.891e+00  
     team31       team32       team33       team34       team35       team36  
 -1.086e+00   -4.464e+00   -1.736e+00   -4.990e+00   -3.338e+00   -3.650e+00  
     team37       team38       team39       team40       team41       team42  
 -2.824e+00   -4.127e+00   -2.285e+00   -4.684e+00   -3.745e+00   -4.577e+00  
     team43       team44       team45       team46       team47       team48  
 -2.726e+00   -4.999e+00   -2.425e+00   -1.939e+00   -1.572e+00   -4.508e+00  
     team49       team50       team51       team52       team53       team54  
 -1.455e+00   -5.121e+00   -4.198e+00   -4.462e+00   -3.616e+00   -4.438e+00  
     team55       team56       team57       team58       team59       team60  
 -3.650e+00   -5.333e+00   -3.133e+00   -3.830e+00   -2.027e+00   -4.898e+00  
     team61       team62       team63       team64    opponent2    opponent3  
 -3.720e+00   -3.863e+00   -1.886e+00   -4.904e+00    3.953e+00    3.746e+00  
  opponent4    opponent5    opponent6    opponent7    opponent8    opponent9  
  3.640e+00    3.096e+00    3.927e+00    2.400e+00    4.175e+00    2.861e+00  
 opponent10   opponent11   opponent12   opponent13   opponent14   opponent15  
  3.058e+00    1.477e+00    4.437e+00    2.430e+00    3.284e+00    1.848e+00  
 opponent16   opponent17   opponent18   opponent19   opponent20   opponent21  
  4.798e+00    9.495e-01    4.409e+00    3.388e+00    3.839e+00    3.012e+00  
 opponent22   opponent23   opponent24   opponent25   opponent26   opponent27  
  4.524e+00    1.890e+00    4.064e+00    3.372e+00    3.929e+00    2.412e+00  
 opponent28   opponent29   opponent30   opponent31   opponent32   opponent33  
  4.702e+00    3.180e+00    2.891e+00    1.086e+00    4.464e+00    1.736e+00  
 opponent34   opponent35   opponent36   opponent37   opponent38   opponent39  
  4.990e+00    3.338e+00    3.650e+00    2.824e+00    4.127e+00    2.285e+00  
 opponent40   opponent41   opponent42   opponent43   opponent44   opponent45  
  4.684e+00    3.745e+00    4.577e+00    2.726e+00    4.999e+00    2.425e+00  
 opponent46   opponent47   opponent48   opponent49   opponent50   opponent51  
  1.939e+00    1.572e+00    4.508e+00    1.455e+00    5.121e+00    4.198e+00  
 opponent52   opponent53   opponent54   opponent55   opponent56   opponent57  
  4.462e+00    3.616e+00    4.438e+00    3.650e+00    5.333e+00    3.133e+00  
 opponent58   opponent59   opponent60   opponent61   opponent62   opponent63  
  3.830e+00    2.027e+00    4.898e+00    3.720e+00    3.863e+00    1.886e+00  
 opponent64  
  4.904e+00  

Degrees of Freedom: 4017 Total (i.e. Null);  3891 Residual
Null Deviance:	    26400000 
Residual Deviance: 800600 	AIC: 820400
> summary(fit)

Call:
glm(formula = cbind(won, lost) ~ team + opponent, family = binomial(logit), 
    data = games)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-278.733    -3.184     0.000     3.184   278.733  

Coefficients:
              Estimate Std. Error z value Pr(>|z|)    
(Intercept)  2.087e-15  3.496e-03     0.0        1    
team2       -3.953e+00  9.872e-03  -400.5   <2e-16 ***
team3       -3.746e+00  8.458e-03  -442.9   <2e-16 ***
team4       -3.640e+00  8.415e-03  -432.6   <2e-16 ***
team5       -3.096e+00  5.138e-03  -602.7   <2e-16 ***
team6       -3.927e+00  5.547e-03  -708.0   <2e-16 ***
team7       -2.400e+00  4.861e-03  -493.6   <2e-16 ***
team8       -4.175e+00  5.758e-03  -725.2   <2e-16 ***
team9       -2.861e+00  4.702e-03  -608.4   <2e-16 ***
team10      -3.058e+00  4.840e-03  -631.8   <2e-16 ***
team11      -1.477e+00  3.802e-03  -388.4   <2e-16 ***
team12      -4.437e+00  7.231e-03  -613.5   <2e-16 ***
team13      -2.430e+00  4.356e-03  -557.9   <2e-16 ***
team14      -3.284e+00  4.893e-03  -671.2   <2e-16 ***
team15      -1.848e+00  3.938e-03  -469.2   <2e-16 ***
team16      -4.798e+00  7.441e-03  -644.8   <2e-16 ***
team17      -9.495e-01  3.641e-03  -260.8   <2e-16 ***
team18      -4.409e+00  8.336e-03  -528.9   <2e-16 ***
team19      -3.388e+00  6.079e-03  -557.4   <2e-16 ***
team20      -3.839e+00  6.360e-03  -603.5   <2e-16 ***
team21      -3.012e+00  4.964e-03  -606.7   <2e-16 ***
team22      -4.524e+00  5.962e-03  -758.8   <2e-16 ***
team23      -1.890e+00  4.143e-03  -456.1   <2e-16 ***
team24      -4.064e+00  5.888e-03  -690.2   <2e-16 ***
team25      -3.372e+00  5.027e-03  -670.9   <2e-16 ***
team26      -3.929e+00  5.308e-03  -740.1   <2e-16 ***
team27      -2.412e+00  4.349e-03  -554.7   <2e-16 ***
team28      -4.702e+00  6.309e-03  -745.4   <2e-16 ***
team29      -3.180e+00  5.255e-03  -605.1   <2e-16 ***
team30      -2.891e+00  5.053e-03  -572.3   <2e-16 ***
team31      -1.086e+00  3.659e-03  -296.9   <2e-16 ***
team32      -4.464e+00  8.309e-03  -537.3   <2e-16 ***
team33      -1.736e+00  4.094e-03  -424.1   <2e-16 ***
team34      -4.990e+00  8.196e-03  -608.9   <2e-16 ***
team35      -3.338e+00  5.316e-03  -627.9   <2e-16 ***
team36      -3.650e+00  5.500e-03  -663.6   <2e-16 ***
team37      -2.824e+00  4.783e-03  -590.4   <2e-16 ***
team38      -4.127e+00  5.616e-03  -734.8   <2e-16 ***
team39      -2.285e+00  4.417e-03  -517.2   <2e-16 ***
team40      -4.684e+00  6.561e-03  -713.9   <2e-16 ***
team41      -3.745e+00  5.352e-03  -699.7   <2e-16 ***
team42      -4.577e+00  5.800e-03  -789.1   <2e-16 ***
team43      -2.726e+00  4.623e-03  -589.7   <2e-16 ***
team44      -4.999e+00  6.457e-03  -774.2   <2e-16 ***
team45      -2.425e+00  4.427e-03  -547.8   <2e-16 ***
team46      -1.939e+00  6.232e-03  -311.1   <2e-16 ***
team47      -1.572e+00  4.084e-03  -384.9   <2e-16 ***
team48      -4.508e+00  7.517e-03  -599.7   <2e-16 ***
team49      -1.455e+00  3.920e-03  -371.3   <2e-16 ***
team50      -5.121e+00  9.192e-03  -557.1   <2e-16 ***
team51      -4.198e+00  6.778e-03  -619.3   <2e-16 ***
team52      -4.462e+00  6.903e-03  -646.5   <2e-16 ***
team53      -3.616e+00  5.120e-03  -706.2   <2e-16 ***
team54      -4.438e+00  5.475e-03  -810.6   <2e-16 ***
team55      -3.650e+00  4.980e-03  -733.0   <2e-16 ***
team56      -5.333e+00  5.481e-03  -973.1   <2e-16 ***
team57      -3.133e+00  5.037e-03  -622.0   <2e-16 ***
team58      -3.830e+00  5.425e-03  -706.0   <2e-16 ***
team59      -2.027e+00  4.246e-03  -477.4   <2e-16 ***
team60      -4.898e+00  7.368e-03  -664.7   <2e-16 ***
team61      -3.720e+00  5.573e-03  -667.4   <2e-16 ***
team62      -3.863e+00  5.651e-03  -683.5   <2e-16 ***
team63      -1.886e+00  4.147e-03  -454.9   <2e-16 ***
team64      -4.904e+00  7.551e-03  -649.4   <2e-16 ***
opponent2    3.953e+00  9.872e-03   400.5   <2e-16 ***
opponent3    3.746e+00  8.458e-03   442.9   <2e-16 ***
opponent4    3.640e+00  8.415e-03   432.6   <2e-16 ***
opponent5    3.096e+00  5.138e-03   602.7   <2e-16 ***
opponent6    3.927e+00  5.547e-03   708.0   <2e-16 ***
opponent7    2.400e+00  4.861e-03   493.6   <2e-16 ***
opponent8    4.175e+00  5.758e-03   725.2   <2e-16 ***
opponent9    2.861e+00  4.702e-03   608.4   <2e-16 ***
opponent10   3.058e+00  4.840e-03   631.8   <2e-16 ***
opponent11   1.477e+00  3.802e-03   388.4   <2e-16 ***
opponent12   4.437e+00  7.231e-03   613.5   <2e-16 ***
opponent13   2.430e+00  4.356e-03   557.9   <2e-16 ***
opponent14   3.284e+00  4.893e-03   671.2   <2e-16 ***
opponent15   1.848e+00  3.938e-03   469.2   <2e-16 ***
opponent16   4.798e+00  7.441e-03   644.8   <2e-16 ***
opponent17   9.495e-01  3.641e-03   260.8   <2e-16 ***
opponent18   4.409e+00  8.336e-03   528.9   <2e-16 ***
opponent19   3.388e+00  6.079e-03   557.4   <2e-16 ***
opponent20   3.839e+00  6.360e-03   603.5   <2e-16 ***
opponent21   3.012e+00  4.964e-03   606.7   <2e-16 ***
opponent22   4.524e+00  5.962e-03   758.8   <2e-16 ***
opponent23   1.890e+00  4.143e-03   456.1   <2e-16 ***
opponent24   4.064e+00  5.888e-03   690.2   <2e-16 ***
opponent25   3.372e+00  5.027e-03   670.9   <2e-16 ***
opponent26   3.929e+00  5.308e-03   740.1   <2e-16 ***
opponent27   2.412e+00  4.349e-03   554.7   <2e-16 ***
opponent28   4.702e+00  6.309e-03   745.4   <2e-16 ***
opponent29   3.180e+00  5.255e-03   605.1   <2e-16 ***
opponent30   2.891e+00  5.053e-03   572.3   <2e-16 ***
opponent31   1.086e+00  3.659e-03   296.9   <2e-16 ***
opponent32   4.464e+00  8.309e-03   537.3   <2e-16 ***
opponent33   1.736e+00  4.094e-03   424.1   <2e-16 ***
opponent34   4.990e+00  8.196e-03   608.9   <2e-16 ***
opponent35   3.338e+00  5.316e-03   627.9   <2e-16 ***
opponent36   3.650e+00  5.500e-03   663.6   <2e-16 ***
opponent37   2.824e+00  4.783e-03   590.4   <2e-16 ***
opponent38   4.127e+00  5.616e-03   734.8   <2e-16 ***
opponent39   2.285e+00  4.417e-03   517.2   <2e-16 ***
opponent40   4.684e+00  6.561e-03   713.9   <2e-16 ***
opponent41   3.745e+00  5.352e-03   699.7   <2e-16 ***
opponent42   4.577e+00  5.800e-03   789.1   <2e-16 ***
opponent43   2.726e+00  4.623e-03   589.7   <2e-16 ***
opponent44   4.999e+00  6.457e-03   774.2   <2e-16 ***
opponent45   2.425e+00  4.427e-03   547.8   <2e-16 ***
opponent46   1.939e+00  6.232e-03   311.1   <2e-16 ***
opponent47   1.572e+00  4.084e-03   384.9   <2e-16 ***
opponent48   4.508e+00  7.517e-03   599.7   <2e-16 ***
opponent49   1.455e+00  3.920e-03   371.3   <2e-16 ***
opponent50   5.121e+00  9.192e-03   557.1   <2e-16 ***
opponent51   4.198e+00  6.778e-03   619.3   <2e-16 ***
opponent52   4.462e+00  6.903e-03   646.5   <2e-16 ***
opponent53   3.616e+00  5.120e-03   706.2   <2e-16 ***
opponent54   4.438e+00  5.475e-03   810.6   <2e-16 ***
opponent55   3.650e+00  4.980e-03   733.0   <2e-16 ***
opponent56   5.333e+00  5.481e-03   973.1   <2e-16 ***
opponent57   3.133e+00  5.037e-03   622.0   <2e-16 ***
opponent58   3.830e+00  5.425e-03   706.0   <2e-16 ***
opponent59   2.027e+00  4.246e-03   477.4   <2e-16 ***
opponent60   4.898e+00  7.368e-03   664.7   <2e-16 ***
opponent61   3.720e+00  5.573e-03   667.4   <2e-16 ***
opponent62   3.863e+00  5.651e-03   683.5   <2e-16 ***
opponent63   1.886e+00  4.147e-03   454.9   <2e-16 ***
opponent64   4.904e+00  7.551e-03   649.4   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 26403350  on 4017  degrees of freedom
Residual deviance:   800567  on 3891  degrees of freedom
AIC: 820390

Number of Fisher Scoring iterations: 5

> exp(coef(fit))
 (Intercept)        team2        team3        team4        team5        team6 
1.000000e+00 1.918845e-02 2.360817e-02 2.624892e-02 4.521554e-02 1.969909e-02 
       team7        team8        team9       team10       team11       team12 
9.075593e-02 1.537122e-02 5.723448e-02 4.700406e-02 2.284159e-01 1.183416e-02 
      team13       team14       team15       team16       team17       team18 
8.803972e-02 3.748166e-02 1.576228e-01 8.247226e-03 3.869422e-01 1.217240e-02 
      team19       team20       team21       team22       team23       team24 
3.376532e-02 2.152341e-02 4.921488e-02 1.084741e-02 1.511241e-01 1.718410e-02 
      team25       team26       team27       team28       team29       team30 
3.430978e-02 1.967312e-02 8.962605e-02 9.073703e-03 4.158497e-02 5.549806e-02 
      team31       team32       team33       team34       team35       team36 
3.374178e-01 1.151379e-02 1.761700e-01 6.804456e-03 3.550987e-02 2.599185e-02 
      team37       team38       team39       team40       team41       team42 
5.937888e-02 1.613305e-02 1.018244e-01 9.238509e-03 2.363737e-02 1.028765e-02 
      team43       team44       team45       team46       team47       team48 
6.548146e-02 6.741932e-03 8.847451e-02 1.438957e-01 2.075982e-01 1.101748e-02 
      team49       team50       team51       team52       team53       team54 
2.332860e-01 5.969319e-03 1.502998e-02 1.153395e-02 2.689635e-02 1.181477e-02 
      team55       team56       team57       team58       team59       team60 
2.598622e-02 4.828462e-03 4.359766e-02 2.170512e-02 1.317446e-01 7.463300e-03 
      team61       team62       team63       team64    opponent2    opponent3 
2.424493e-02 2.101511e-02 1.516358e-01 7.420116e-03 5.211468e+01 4.235822e+01 
   opponent4    opponent5    opponent6    opponent7    opponent8    opponent9 
3.809680e+01 2.211629e+01 5.076377e+01 1.101856e+01 6.505666e+01 1.747198e+01 
  opponent10   opponent11   opponent12   opponent13   opponent14   opponent15 
2.127476e+01 4.377978e+00 8.450116e+01 1.135851e+01 2.667972e+01 6.344260e+00 
  opponent16   opponent17   opponent18   opponent19   opponent20   opponent21 
1.212529e+02 2.584366e+00 8.215304e+01 2.961619e+01 4.646103e+01 2.031906e+01 
  opponent22   opponent23   opponent24   opponent25   opponent26   opponent27 
9.218791e+01 6.617079e+00 5.819333e+01 2.914621e+01 5.083078e+01 1.115747e+01 
  opponent28   opponent29   opponent30   opponent31   opponent32   opponent33 
1.102086e+02 2.404715e+01 1.801865e+01 2.963685e+00 8.685240e+01 5.676334e+00 
  opponent34   opponent35   opponent36   opponent37   opponent38   opponent39 
1.469625e+02 2.816118e+01 3.847359e+01 1.684100e+01 6.198457e+01 9.820826e+00 
  opponent40   opponent41   opponent42   opponent43   opponent44   opponent45 
1.082426e+02 4.230589e+01 9.720395e+01 1.527150e+01 1.483254e+02 1.130269e+01 
  opponent46   opponent47   opponent48   opponent49   opponent50   opponent51 
6.949476e+00 4.816998e+00 9.076484e+01 4.286583e+00 1.675233e+02 6.653371e+01 
  opponent52   opponent53   opponent54   opponent55   opponent56   opponent57 
8.670057e+01 3.717976e+01 8.463979e+01 3.848194e+01 2.071053e+02 2.293701e+01 
  opponent58   opponent59   opponent60   opponent61   opponent62   opponent63 
4.607208e+01 7.590447e+00 1.339890e+02 4.124573e+01 4.758482e+01 6.594750e+00 
  opponent64 
1.347688e+02 
> 
> 
